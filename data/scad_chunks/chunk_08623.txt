function _midpt_smooth_sub(points, iend, closed) = 
    [
        each [
            for(i = 0; i < iend; i = i + 1) 
                (points[i] + points[i + 1]) / 2
        ],
        if(closed) (points[iend] + points[0]) / 2
    ];