module woven_sheet(type, thickness, colour, colour2, w, d) { // Create a woven 2D sheet with specified thickness and colours
    warp = sheet_warp(type);
    weft = sheet_weft(type);
    warp_doublet_count = assert(!is_undef(w) && !is_undef(d), "Must specify the dimensions to render woven sheets") ceil(w / (2 * warp));
    weft_count = ceil(d / weft);

    module chequerboard(odd = 0)
        translate([-w / 2, -d / 2])
            for (y = [0 : weft_count - 1], x = [0 : warp_doublet_count - 1])
                translate([warp * (2 * x + ((y + odd) % 2)), weft * y])
                    square([warp, weft]);

    color(colour)
        linear_extrude(thickness)
            intersection() {
                chequerboard();
                children();
            }

    if(thickness > eps)
        color(colour2)
            linear_extrude(thickness)
                intersection() {
                    chequerboard(1);

                    not_on_bom()
                        children();
                }
}