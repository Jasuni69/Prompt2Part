function sampling_noAdjacentNeighbor(s, sample, x, y, z) = 
    let(me = [x, y, z])
    every(NBRS,
        function(NBR) 
            let(nbr = me + NBR)
            !sampling_inLayer(s, nbr.z) ||
            !sampling_inRow(s, nbr.y) ||
            (let(p = sampling_grid(s)[nbr.z][nbr.y][nbr.x])
            is_undef(p) ||
            norm(sample - p) >= sampling_r(s))
    );