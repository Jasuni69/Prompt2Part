module iec_holes(type, h = 100, poly = false, horizontal = false, insert = false) { //! Drill the required panel holes
    clearance = iec_can(type) ? 1 : 0.2;
    screw = iec_screw(type);
    insert_type = screw_insert(screw);
    insert_overlap = max(0, insert_screw_length + clearance - iec_flange_t(type) - insert_hole_length(insert_type));

    iec_screw_positions(type)
        if(insert)
            if(h)
                insert_hole(insert_type, insert_overlap, horizontal = horizontal);
            else
                poly_circle(insert_hole_radius(insert_type));
        else
            if(horizontal)
                teardrop_plus(r = screw_clearance_radius(screw), h = h);
            else
                if(poly)
                    poly_cylinder(r = screw_clearance_radius(screw), h = h, center = true);
                else
                    drill(screw_clearance_radius(screw), h);

    extrude_if(h)
        hull()
            for(x = [-1, 1], y = [-1, 1], sag = horizontal && y > 1 ? layer_height : 0)
                translate([x * (iec_body_w(type) / 2 - iec_body_r(type)), y * (iec_body_h(type) / 2  - iec_body_r(type) + sag )])
                    if(horizontal)
                        teardrop(0, iec_body_r(type) + clearance / 2 + layer_height / 4);
                    else
                        drill(iec_body_r(type) + clearance / 2, 0);
}