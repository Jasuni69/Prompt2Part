module test_map() {
    l1 = [1,2,3,4,5,6,7,8];
    l2 = [7,3,9,1,6,1,3,2];
    x3 = function (x) x*3;
    d3 = function (x) x/3;
    xx = function (x) x*x;
    assert_approx(map(x3,l1), l1*3);
    assert_approx(map(x3,l2), l2*3);
    assert_approx(map(d3,l1), l1/3);
    assert_approx(map(d3,l2), l2/3);
    assert_approx(map(xx,l1), [for (x=l1) x*x]);
    assert_approx(map(xx,l2), [for (x=l2) x*x]);
}
test_map();