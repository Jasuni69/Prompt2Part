module _driver(spec)
{
  drive = struct_val(spec,"drive");
  if (is_def(drive) && drive!="none") {
    head = struct_val(spec,"head");
    diameter = _nominal_diam(spec);
    drive_size = struct_val(spec,"drive_size");
    drive_diameter = struct_val(spec, "drive_diameter");
    drive_depth = first_defined([struct_val(spec, "drive_depth"), .7*diameter]); // Note hack for unspecified depth
    head_top = starts_with(head,"flat") || head=="none" ? 0 :
               struct_val(spec,"head_height");
    up(head_top-drive_depth){
      // recess should be positioned with its bottom center at (0,0) and the correct recess depth given above
      if (drive=="phillips") phillips_mask(drive_size,anchor=BOTTOM);
      if (drive=="torx") torx_mask(size=drive_size, l=drive_depth+1, center=false);
      if (drive=="hex") hex_drive_mask(drive_size,drive_depth+1,anchor=BOT);
      if (drive=="slot") {
          head_width = first_defined([u_add(struct_val(spec, "head_size"),struct_val(spec,"head_oversize",0)), diameter]);
          cuboid([2*head_width, drive_size, drive_depth+1],anchor=BOTTOM);
      }
    }
  }
}