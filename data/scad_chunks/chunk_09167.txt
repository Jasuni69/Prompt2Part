function next_cells(x, y, dir, cells, rows, columns, x_wrapping, y_wrapping, seed, directions) =
    let(
        nx = next_x(x, dir, columns, x_wrapping),
        ny = next_y(y, dir, rows, y_wrapping)
    )
    !visitable(nx, ny, cells, rows, columns) ? // is the dir visitable?
            cells :   // road closed so return cells directly
            go_maze(  // try the cell 
                nx, ny, 
                carve(dir, x, y, cells, rows, columns),
                rows, columns,
                x_wrapping, y_wrapping,
                seed,
                directions
            );