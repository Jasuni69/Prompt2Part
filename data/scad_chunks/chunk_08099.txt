module step_pyramid_maze(maze_rows, cell_width, stairs_width) {    
    intersection() {
        pyramid_with_stairs(
            maze_rows * cell_width, stairs_width, maze_rows);

        linear_extrude(maze_rows * cell_width * sqrt(2) / 2)  difference() {
            
            square([cell_width * maze_rows + stairs_width, cell_width * maze_rows + stairs_width], center = true);
            
            translate([-(maze_rows * cell_width) / 2, -(maze_rows * cell_width) / 2, 0]) 
            difference() {
                square_maze(maze_rows, cell_width, stairs_width);

                // entry
                translate([0, stairs_width]) 
                    square(stairs_width, center = true);

                // exit
                translate([maze_rows * cell_width, maze_rows * cell_width - stairs_width]) 
                    square(stairs_width, center = true);
            }
        }
    }
}

step_pyramid_maze(maze_rows, cell_width, stairs_width);