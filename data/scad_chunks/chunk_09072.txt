function next_cells(x, y, z, dir, cells, layers, rows, columns, x_wrapping, y_wrapping, z_wrapping, seed) =
    let(
        nx = next_x(x, dir, columns, x_wrapping),
        ny = next_y(y, dir, rows, y_wrapping),
        nz = next_z(z, dir, layers, z_wrapping)
    )
    !visitable(nx, ny, nz, cells, layers, rows, columns) ? // is the dir visitable?
            cells :   // road closed so return cells directly
            go_maze(  // try the cell 
                nx, ny, nz, 
                carve(dir, x, y, z, cells, layers, rows, columns),
                layers, rows, columns,
                x_wrapping, y_wrapping, z_wrapping,
                seed
            );