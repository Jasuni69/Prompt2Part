module batteries()
    layout([for(b = batteries) battery_diameter(b)], 5) let(battery=batteries[$i]) {
        battery = batteries[$i];
        rotate(-135)                            // To show Lumintop USB socket and LEDs
            battery(battery);

        contact = battery_contact(battery);
        translate_z(battery_length(battery) / 2 + contact_pos(contact).x)
            rotate([0, 180, 0])
                battery_contact(contact);

        translate_z(-battery_length(battery) / 2 - contact_neg(contact).x)
            battery_contact(contact, false);
    }

if($preview)
    batteries();