function adjust_bezier_length(v, l, eps = 0.001, r1 = 1.0, r2 = 1.5, l1, l2) = //! Adjust Bezier control points `v` to get the required curve length `l`
    let(l1 = l1 != undef ? l1 : bezier_length(adjust_bezier(v, r1)),
        l2 = l2 != undef ? l2 : bezier_length(adjust_bezier(v, r2))
       ) abs(l1 - l) < eps ? adjust_bezier(v, r1)
                           : let(r = r1 + (l - l1) * (r2 - r1) / (l2 - l1))
                                 abs(r - r1) < abs(r - r2) ? adjust_bezier_length(v, l, eps, r, r1, undef, l1)
                                                           : adjust_bezier_length(v, l, eps, r, r2, undef, l2);