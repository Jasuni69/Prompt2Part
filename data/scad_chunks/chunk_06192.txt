function _parse_drive(drive=undef, drive_size=undef) =
    is_undef(drive) ? ["none",undef] 
  : assert(is_string(drive))
    let(drive = downcase(drive))
    in_list(drive,["hex","phillips", "slot", "torx", "phillips", "none"]) ? [drive, drive_size] 
  : drive[0]=="t" ? let(size = parse_int(substr(drive,1))) ["torx",size,torx_depth(size) ] 
  : starts_with(drive,"ph") && search(drive[2], "01234")!=[] ? ["phillips", ord(drive[2])-ord("0")] 
  : assert(false,str("Unknown screw drive type ",drive));


// Module: screw_head()
// Synopsis: Creates a screw head.
// SynTags: Geom
// Topics: Threading, Screws
// See Also: screw(), screw_hole()
// Usage:
//    screw_head(screw_info, [details],[counterbore],[flat_height],[teardrop],[internal])
// Description:
//    Draws the screw head described by the data structure `screw_info`, which
//    should have the fields produced by {{screw_info()}}.  See that function for
//    details on the fields.  Standard orientation is with the head centered at (0,0)
//    and oriented in the +z direction.  Flat heads appear below the xy plane.
//    Other heads appear sitting on the xy plane.  
// Arguments:
//    screw_info = structure produced by {{screw_info()}}
//    ---
//    details = true for more detailed model.  Default: false
//    counterbore = counterbore height.  Default: no counterbore
//    flat_height = height of flat head (required for flat heads)
//    teardrop = if true make flatheads and counterbores teardrop shaped with the flat 5% away from the edge of the screw.  If numeric, specify the fraction of extra to add.  Set to "max" for a pointed teardrop.  Default: false
//    slop = enlarge diameter by this extra amount (beyond that specified in the screw specification).  Default: 0