function _lsystem_recurse(s, rules, lev) =
    lev<=0? s : _lsystem_recurse([
        for (
            i = 0,
            slen = len(s),
            sout = "";

            i <= slen;

            ch = s[i],
            found = search([ch], rules)[0],
            sout = str(sout, i==slen? "" : found==[]? ch : rules[found][1]),
            i = i + 1
        ) if (i==slen) sout
    ][0], rules, lev-1);